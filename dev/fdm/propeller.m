%%
%% Propeller for Swedish Navy 20m MTB.
%%
%% Known: Diameter 0.7 m(?), pitch ??, diameter of hub ??.
%%        Engine power 1500 hp @ 2000 rpm.
%%        Max speed 50 knots.
%%

%% Assumed properties of seawater
%%   density:             1027.68 kg/m^3
%%   kinematic Viscosity: 0.00000183 m^2/s
%%   speed of sound:      1560 m/s


%% JavaProp parameters.
%%
%%   Diameter                0.7 m
%%   Spinner Dia.  Dsp       0.15 m
%%   Speed of Rotation       1400 1/min
%%   Velocity                25.00 m/s
%%   Number of Blades        3
%%   Power  P                1118550 W
%%

JP = [
%v/(nD)	v/(ΩR)	Ct	Cp	Cs	Pc	η	η*	stalled	v	n	Power	Thrust	Torque
%[-]	[-]	[-]	[-]	[-]	[-]	[%]	[%]	[%]	[m/s]	[1/min]	[MW]	[kN]	[kNm]
0.000	0.000	0.451948	0.800022	0.000033	999999.000000	0.00	0.00	95.00 	0.00	1400	1.76	60.714	11.974
0.100	0.032	0.324710	0.610289	0.110381	1554.088680	5.32	18.88	95.00 	1.63	1400	1.34	43.621	9.134
0.200	0.064	0.453410	0.817480	0.208226	260.211897	11.09	29.13	95.00 	3.27	1400	1.79	60.911	12.235
0.300	0.095	0.452399	0.826217	0.311675	77.923846	16.43	39.94	85.00 	4.90	1400	1.81	60.775	12.366
0.400	0.127	0.447868	0.832505	0.414937	33.124316	21.52	48.93	85.00 	6.53	1400	1.83	60.166	12.460
0.500	0.159	0.440515	0.837929	0.517999	17.070149	26.29	56.44	85.00	8.17	1400	1.84	59.179	12.541
0.600	0.191	0.430371	0.843074	0.620838	9.939210	30.63	62.73	85.00	9.80	1400	1.85	57.816	12.618
0.700	0.223	0.418710	0.848150	0.723442	6.296783	34.56	68.00	85.00	11.43	1400	1.86	56.249	12.694
0.800	0.255	0.412138	0.840697	0.828251	4.181286	39.22	72.15	68.00	13.07	1400	1.84	55.366	12.582
0.900	0.286	0.423636	0.811982	0.938282	2.836344	46.96	74.82	26.00	14.70	1400	1.78	56.911	12.153
1.000	0.318	0.421177	0.793763	1.047278	2.021300	53.06	77.53	0.00	16.33	1400	1.74	56.581	11.880
1.100	0.350	0.394175	0.759825	1.162117	1.453703	57.06	80.69	0.00	17.97	1400	1.67	52.953	11.372
1.200	0.382	0.362651	0.717744	1.282293	1.057709	60.63	83.57	0.00	19.60	1400	1.57	48.718	10.742
1.300	0.414	0.326340	0.665211	1.410430	0.771027	63.78	86.24	0.00	21.23	1400	1.46	43.840	9.956
1.400	0.446	0.284197	0.599869	1.550661	0.556688	66.33	88.78	0.00	22.87	1400	1.32	38.179	8.978
1.500	0.477	0.242305	0.531331	1.702230	0.400896	68.41	91.01	0.00	24.50	1400	1.17	32.551	7.952
1.600	0.509	0.200690	0.459676	1.869088	0.285780	69.85	92.98	0.00	26.13	1400	1.01	26.961	6.880
1.700	0.541	0.154692	0.376972	2.066270	0.195390	69.76	94.87	0.00	27.77	1400	0.83	20.781	5.642
1.720	0.547	0.144318	0.357881	2.112422	0.179099	69.36	95.27	0.00	28.09	1400	0.79	19.388	5.356
1.740	0.554	0.133919	0.338565	2.160831	0.163657	68.83	95.65	0.00	28.42	1400	0.74	17.991	5.067
1.760	0.560	0.123215	0.318542	2.212480	0.148788	68.08	96.04	0.00	28.75	1400	0.70	16.553	4.767
1.780	0.567	0.111306	0.296099	2.270558	0.133696	66.91	96.45	0.00	29.07	1400	0.65	14.953	4.432
1.800	0.573	0.099869	0.274398	2.331290	0.119813	65.51	96.85	0.00	29.40	1400	0.60	13.416	4.107
1.820	0.579	0.092902	0.261125	2.380684	0.110300	64.75	97.10	0.00	29.73	1400	0.57	12.480	3.908
1.840	0.586	0.083817	0.243722	2.440276	0.099628	63.28	97.41	0.00	30.05	1400	0.53	11.260	3.648
1.860	0.592	0.073708	0.224197	2.508342	0.088722	61.15	97.74	0.00	30.38	1400	0.49	9.902	3.355
1.880	0.598	0.064413	0.206190	2.578128	0.079019	58.73	98.04	0.00	30.71	1400	0.45	8.653	3.086
1.900	0.605	0.054466	0.186797	2.657538	0.069351	55.40	98.36	0.00	31.03	1400	0.41	7.317	2.796
1.920	0.611	0.043805	0.165928	2.749903	0.059697	50.69	98.69	0.00	31.36	1400	0.36	5.885	2.483
1.940	0.618	0.033022	0.144737	2.855525	0.050479	44.26	99.02	0.00	31.69	1400	0.32	4.436	2.166
1.960	0.624	0.021983	0.122968	2.980560	0.041588	35.04	99.36	0.00	32.01	1400	0.27	2.953	1.840
1.980	0.630	0.011648	0.102510	3.122569	0.033629	22.50	99.66	0.00	32.34	1400	0.22	1.565	1.534
2.000	0.637	0.001660	0.082692	3.292585	0.026322	4.02	99.95	0.00	32.67	1400	0.18	0.223	1.238
2.020	0.643	-0.008419	0.062670	3.515120	0.019362	0.00	99.99	0.00	32.99	1400	0.14	-1.131	0.938
2.040	0.649	-0.018780	0.042150	3.843007	0.012643	0.00	99.99	0.00	33.32	1400	0.09	-2.523	0.631
2.060	0.656	-0.029144	0.021813	4.427157	0.006354	0.00	99.99	0.00	33.65	1400	0.05	-3.915	0.326
2.080	0.662	-0.039598	0.001358	7.789265	0.000384	0.00	99.99	0.00	33.97	1400	0.00	-5.320	0.020
2.100	0.668	-0.050183	-0.019365	4.621864	-0.005325	0.53	46.47	0.00	34.30	1400	-0.04	-6.742	-0.290
];

C_Thrust1 = [JP(:,1) JP(:,3)];

C_Power1 = [JP(:,1) JP(:,4)];

Efficiency = C_Thrust1(:,1) .* C_Thrust1(:,2) ./ C_Power1(:,2);

%% Full speed: 50kt at 1400 RPM (RPM guessed)
fullspeed_advance = 25/(1400/60*0.7); % v/(nD)

%% Thrust and Power v.s. advance ratio.

figure();
axis();
plot(C_Thrust1(:,1), C_Thrust1(:,2), ";Thrust coeff.;",
     C_Power1(:,1), C_Power1(:,2),   ";Power coeff.;",
     [fullspeed_advance; fullspeed_advance+0.001], [0; 1], "r;full speed v/nD;");
xlabel("Advance ratio");
ylabel("Thrust and power coefficients");
title("Thrust and power v.s. advance ratio.");

%% Efficiency v.s. advance ratio.
figure();
axis([0 1 0 1]);
plot(C_Thrust1(:,1), Efficiency, ";efficiency;",
     [fullspeed_advance; fullspeed_advance+0.001], [0; 1], "r;full speed v/nD;");
axis([0 2 0 1]);
xlabel("Advance ratio");
ylabel("Efficiency");
title("Efficiency v.s. advance ratio.");

Advance = 0:0.05:3.00;

C_Thrust = [Advance' \
            interp1(C_Thrust1(:,1),C_Thrust1(:,2), Advance, 'extrap')'];

C_Power = [Advance' \
           interp1(C_Power1(:,1),C_Power1(:,2), Advance, 0.01)'];

figure();
plot(Advance, C_Thrust(:,2), Advance, C_Power(:,2));
plot(Advance, C_Thrust(:,2), ";Thrust coeff.;",
     Advance, C_Power(:,2),  ";Power coeff.;",
     [fullspeed_advance; fullspeed_advance+0.001], [0; 1], "r;full speed v/nD;");
xlabel("Advance ratio");
ylabel("Thrust and power coefficients");
title("Thrust and power v.s. advance ratio.");
